<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta property="og:title" content="The Wrong Way to Use Javascript"><meta property="og:description" content="I&rsquo;ve been taking a bit of a coding vacation. Before I jump back into things, I decided to do a little housekeeping and clean the cobwebs from my interwebs. Specifically, reducing the level of annoying coming out of Facebook.
Look at this nonsense right here:
Wow, what a great user experience! Having to un-check 60-odd check-boxes individually is just great. I&rsquo;m sure the team of 15 out of 1,000 Facebook engineers that built this page thought this was really clever."><meta property="og:type" content="article"><meta property="og:url" content="https://the.fringe.ninja/2013/12/27/the-wrong-way-to-use-javascript/"><meta property="article:published_time" content="2013-12-27T11:06:21-08:00"><meta property="article:modified_time" content="2013-12-27T11:06:21-08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="The Wrong Way to Use Javascript"><meta name=twitter:description content="I&rsquo;ve been taking a bit of a coding vacation. Before I jump back into things, I decided to do a little housekeeping and clean the cobwebs from my interwebs. Specifically, reducing the level of annoying coming out of Facebook.
Look at this nonsense right here:
Wow, what a great user experience! Having to un-check 60-odd check-boxes individually is just great. I&rsquo;m sure the team of 15 out of 1,000 Facebook engineers that built this page thought this was really clever."><meta name=description content><link rel=canonical href=https://the.fringe.ninja/2013/12/27/the-wrong-way-to-use-javascript/><title>The Wrong Way to Use Javascript &#183; Ninja Snacks</title><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css><link href=https://the.fringe.ninja/css/style.css rel=stylesheet></head><body><nav class=white role=navigation><div class="row max-width"><div class="col s12 l10 offset-l1"><a href=# data-target=nav-mobile class="sidenav-trigger black-text"><i class=material-icons>menu</i></a><ul id=nav-mobile class=sidenav><li><a class=black-text href=/><i class="material-icons left">home</i>Home</a></li><li><a class=black-text href=/resume><i class="material-icons left">assignment</i>Resume</a></li></ul><a href=/ class="brand-logo grey-text text-darken-3">Ninja Snacks <small>- Tales from the Enterprise</small></a><div class=nav-wrapper><ul class="right hide-on-med-and-down"><li><a class=black-text href=/><i class="material-icons left">home</i>Home</a></li><li><a class=black-text href=/resume><i class="material-icons left">assignment</i>Resume</a></li></ul></div></div></div></nav><article class=max-width><header class=row><div class="col s12 m10 offset-m1 l10 offset-l1"><h1>The Wrong Way to Use Javascript</h1><address>João P. Bragança</address><time datetime=2013-12-27>Fri, 27 Dec 2013 11:06</time></div></header><section class=row><div class="col s12 m10 offset-m1 l10 offset-l1"><p>I&rsquo;ve been taking a bit of a coding vacation. Before I jump back into things, I decided to do a little housekeeping and clean the cobwebs from my interwebs. Specifically, reducing the level of annoying coming out of Facebook.</p><p>Look at this nonsense right here:</p><p><img src=http://i.imgur.com/GgSSJin.png alt title="ಠ_ಠ Facebook sucks and so does their code. ಠ_ಠ"></p><p>Wow, what a great user experience! Having to un-check 60-odd check-boxes <em>individually</em> is just great. I&rsquo;m sure the team of 15 out of 1,000 Facebook engineers that built this page thought this was really clever. We&rsquo;re using javascript to enhance the page! Weeeee!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;async&#34;</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/ajax/settings/notifications/update_app&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span> <span style=color:#a6e22e>onsubmit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;return window.Event &amp;amp;&amp;amp; Event.__inlineSubmit &amp;amp;&amp;amp; Event.__inlineSubmit(this,event)&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;u_o_e&#34;</span>&gt;
    &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;hidden&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fb_dtsg&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;....&#34;</span> <span style=color:#a6e22e>autocomplete</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;off&#34;</span>&gt;
    &lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;uiLoadingIndicatorAsync img&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://fbstatic-a.akamaihd.net/rsrc.php/v2/yb/r/GsNJNwuI-UM.gif&#34;</span> <span style=color:#a6e22e>alt</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;16&#34;</span> <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;11&#34;</span>&gt;
    &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;checkbox&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;checked&#34;</span> <span style=color:#a6e22e>checked</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;u_o_f&#34;</span>&gt;
    &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;hidden&#34;</span> <span style=color:#a6e22e>autocomplete</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;off&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12345&#34;</span>&gt;
&lt;/<span style=color:#f92672>form</span>&gt;
</code></pre></div><p>(26 Javascript resources out of 86 total to render this simple page by the way).</p><p>The javascript on this page apparently exists to allow the user to turn application feed notifications on and off individually. Can we apply REST principles and provide the user with a better experience? Yes, we can!</p><p>The REST style is a document based style. It tends to favor <em>coarse-grained</em> resources over fine-grained ones, if only for the cache-ability.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>GET /user/12345/application-notifications
Accept: text/html
Authorization: ...


200 Ok
Content-Type: text/html
Cache-control: private

&lt;<span style=color:#f92672>html</span>&gt;
    &lt;<span style=color:#f92672>body</span>&gt;
        &lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/user/12345/application-notifications&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;POST&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;application-notifications&#34;</span>&gt;
            <span style=color:#75715e>&lt;!-- each value here represents an application id --&gt;</span>
            &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;checkbox&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12345&#34;</span> <span style=color:#a6e22e>checked</span> &gt;
            &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;checkbox&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;67890&#34;</span> &gt;
            
            &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Submit&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34; Submit &#34;</span> &gt;
        &lt;/<span style=color:#f92672>form</span>&gt;
    &lt;/<span style=color:#f92672>body</span>&gt;
&lt;/<span style=color:#f92672>html</span>&gt;
</code></pre></div><p>Admittedly, the user experience has not improved over what Facebook is currently providing us. However, there are two improvements. 1) Only one remote call to set all preferences at once. 2) A lot less complicated than putting an ajax form around each checkbox and having to wire that up.</p><p>What about the enhancement? We can (and should) use javascript here to enhance the user experience.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/javascript&#34;</span>&gt;
    (<span style=color:#66d9ef>function</span>(document){
        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>form</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;application-notifications&#34;</span>);
        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>checkboxes</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>form</span>.<span style=color:#a6e22e>querySelectorAll</span>(<span style=color:#e6db74>&#39;input[type=&#34;checkbox&#34;]&#39;</span>);
        
        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>setCheckState</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>value</span>) {
            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>checkboxes</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
                <span style=color:#a6e22e>checkboxes</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>checked</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span>;
            }
        }
        
        <span style=color:#75715e>// use your imagination on how to wire this up to some buttons.
</span><span style=color:#75715e></span>    })(document);
&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div><p>There. We just replaced a whole bunch of overly complicated ajax-y nonsense with 10 lines of javascript. And provided IMO the user with a better experience.</p></div></section><footer class=row><div class="col s12 m10 offset-m1 l10 offset-l1"><p class=article-meta><a class=btn-small href=https://the.fringe.ninja/tags/rest/>rest</a>
<a class=btn-small href=https://the.fringe.ninja/tags/ux/>ux</a>
<a class=btn-small href=https://the.fringe.ninja/tags/rant/>rant</a></p></div></footer></article><footer class="page-footer grey lighten-5"><div class="row max-width"><div class="col s12 l10 offset-l1 clear-padding"><div class=row></div></div></div><div class=footer-copyright><div class="row max-width" style=width:100%><div class="col s12 l10 offset-l1"><span class="grey-text text-darken-4"></span><div class=right></div></div></div></div></footer><script src=https://code.jquery.com/jquery-3.2.1.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js></script><script src=https://the.fringe.ninja/js/script.js></script></body></html>